{% extends "::base.html.twig" %}

{% block titulo %}Modificar Permisos - {% endblock %}
        {% block stylesheets %}
        <link href="{{asset('css/bootstrap.css')}}" media="screen" rel="stylesheet" type="text/css">
        <link href="{{asset('css/style.css')}}" media="screen" rel="stylesheet" type="text/css">
        <link href="{{asset('css/bootstrap-responsive.css')}}" media="screen" rel="stylesheet" type="text/css">
                 
        <!-- Scripts -->
                 
        {% endblock %}
        
{% block content %}

      <div class="span9" id="registro_form">
            
          <fieldset>  
                  <legend>Modificar Permisos</legend>
                  
                  
          <form id="myForm" name="myForm" class="form-horizontal"  method="POST" action="{{path('administrar_mod_permiso_update')}}" >
         
              
                  
                  <div class="control-group">
                    <label class="control-label" >ID</label>
                    <div class="controls">
                      <input class="input-large" type="text" name="code" id="code" pattern="|^\d+$|" autofocus="true" required/>
                      <input class="btn btn-primary" type="button" name="load" id="load" value="Cargar"  onclick="cargar();"/>
                    </div>
                  </div>
              
                  <div class="control-group">
                      <label class="control-label"></label>
                      <div class="controls" id="divusuario">
                        <label class="checkbox">
                            <input type="checkbox" name="usuario" id="usuario" value="usuario"> Usuario
                        </label>
                      </div>
                   </div>
              
              
                  <div class="control-group">
                      <label class="control-label"></label>
                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="celula" id="celula" value="celula"> Lider de Célula
                        </label>
                      </div>
                   </div>
              
                  <div class="control-group">
                      <label class="control-label"></label>
                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="consolidador" id="consolidador" value="consolidador">Consolidador
                        </label>
                       </div>
                  </div>
                  
              <div class="control-group">
                       <label class="control-label"></label>

                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="estudiante" id="estudiante" value="estudiante">Estudiante                          
                        </label>
                      </div>
                  </div>
              
               <div class="control-group">
                       <label class="control-label"></label>

                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="docente" id="docente" value="docente">Docente                          
                        </label>
                      </div>
                  </div>
              
              <div class="control-group">
                      <label class="control-label"></label>

                      <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="misionero" id="misionero" value="misionero"> Misionero
                            </label>
                      </div>
                  </div>
              
                  <div class="control-group">
                      <label class="control-label"></label>
                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="lider_red" id="lider_red" value="lider_red"> Lider de Red
                        </label>
                       </div>
                  </div>
              
                  <div class="control-group">
                      <label class="control-label"></label>

                      <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="ganar" id="ganar" value="ganar"> Encargado de Ganar
                            </label>
                      </div>
                  </div>
                  
                  <div class="control-group">
                      <label class="control-label"></label>

                      <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="consolidar" id="consolidar" value="consolidar"> Encargado de Consolidar
                            </label>
                      </div>
                  </div>
              
              <div class="control-group">
                      <label class="control-label"></label>

                      <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="discipular" id="discipular" value="discipular"> Encargado de Discipular
                            </label>
                      </div>
                  </div>
              
              <div class="control-group">
                      <label class="control-label"></label>

                      <div class="controls">
                            <label class="checkbox">
                                <input type="checkbox" name="enviar" id="enviar" value="enviar"> Encargado de Enviar
                            </label>
                      </div>
                  </div>
                  <div class="control-group">
                    <label class="control-label"></label>
                    <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="pastor_asoc" id="pastor_asoc" value="pastor_asoc"> Pastor Asociado
                        </label>
                    </div>
                  </div>
                                                  
                  
                  <div class="control-group">
                  
                      <label class="control-label"></label>
                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="pastor_eje" id="pastor_eje" value="pastor_eje"> Pastor Ejecutivo
                        </label>
                      </div>
                  </div>
                  
                  <div class="control-group">
                  
                      <label class="control-label"></label>
                      <div class="controls">
                        <label class="checkbox">
                            <input type="checkbox" name="admin" id="admin" value="admin"> Administrador
                        </label>
                      </div>
                  </div>
                  
                  
               
              <div class="control-group">
                  <label class="control-label"></label>
                  <div class="controls">
                      <input class="btn btn-small btn-primary" type="submit" name="login" title="Guardar" value="Guardar" />
                  </div>
              </div>
              
              
              <div id="usuariodiv">
                   <fieldset>
                <legend>Usuario</legend>
                <div class="control-group">
                    <label class="control-label" >Usuario</label>
                    <div class="controls">
                        <input type="text" id="inputUsuario" name="inputUsuario" placeholder="Usuario" class="input-xlarge" pattern="|^[a-zA-Z0-9]+$|" />
                    </div>
                </div>
               
                <div class="control-group">     
                    <label class="control-label" >Contraseña</label>      
                    <div class="controls">
                        <input type="password" id="inputPassword" name="inputPassword" placeholder="Contraseña" class="input-xlarge" value="clm">      
                    </div>
                </div>
          
                
            </fieldset>
              </div>     
          
        </form>
                
       </fieldset>
              
        

</div>
{% endblock %}
      
               
      {%block javascript %}
      <script type="text/javascript" src="{{asset('js/jquery.js')}}"></script>
            <script type="text/javascript" language="javascript" src="{{asset('js/media/js/jquery.dataTables.js')}}"></script>

            <script type="text/javascript" src="{{asset('js/bootstrap-typeahead.js')}}"></script>
            <script type="text/javascript" src="{{asset('js/bootstrap-collapse.js')}}"></script>
            <script type="text/javascript" src="{{asset('js/bootstrap-button.js')}}"></script>
            <script type="text/javascript" src="{{asset('js/bootstrap-tooltip.js')}}"></script>
            <script type="text/javascript" src="{{asset('js/bootstrap-tab.js')}}"></script>
            <script type="text/javascript" src="{{asset('js/bootstrap.js')}}"></script>    
            <script src="{{asset('js/custom.js')}}"></script>              
            <!--[if lt IE 9]> <script type="text/javascript" src="{{asset('js/html5.js')}}"></script><![endif]-->
      
      
      <script type="text/javascript">
          
    
        function permiso(dato)
        {
            
            
            console.log(dato);
            
           // if(dato.ROLE_USER === true)
             //   $('#usuario').attr('checked',true);
            
            if(dato.ROLE_LIDER === true)
                $('#celula').attr('checked', true); 

            if(dato.ROLE_LIDER_RED === true)
                $('#lider_red').attr('checked', true); 

            if(dato.ROLE_MISIONERO === true)
                $('#misionero').attr('checked', true); 

            if(dato.ROLE_PASTOR_EJECUTIVO === true)
                $('#pastor_eje').attr('checked', true); 

                
            if(dato.ROLE_PASTOR_ASOCIADO === true)
                $('#pastor_asoc').attr('checked', true); 

                
            if(dato.ROLE_GANAR === true)
                $('#ganar').attr('checked', true); 
            
            if(dato.ROLE_CONSOLIDAR === true)
                $('#consolidar').attr('checked', true); 
                
            if(dato.ROLE_DISCIPULAR === true)
                $('#discipular').attr('checked', true); 
                
            if(dato.ROLE_ESTUDIANTE === true)
               $('#estudiante').attr('checked', true); 
           
            //if(dato.ROLE_PROFESOR === TRUE)
                
            
            if(dato.ROLE_ENVIAR === true)
                $('#enviar').attr('checked', true); 

                
            if(dato.ROLE_CONSOLIDADOR=== true)                
                $('#consolidador').attr('checked', true); 

           if(dato.ROLE_ADMIN=== true)                
                $('#admin').attr('checked', true); 
        }
        
        //recuperar los datos
        function user(dato)
        {
            if(dato!==false)
            {
                      $('#usuariodiv') .css({'display':'none'});                      
                      $('#divusuario').css({'display':'none'});            
            }
            else {     
                $('#usuariodiv') .css({'display':'block'});
                $('#divusuario').css({'display':'none'});
            }

        }
        function cargar()
        {
                var id = $("#code").val();

                 var route = '{{path('servicio_permiso_id',{'id': 'nom'})}}';            
                 var rutas = route.replace('nom',id); 
                 
                 if(id.length > 0)   
                 {
                     
                 
                    $.ajax(
                        {   url : rutas,
                            dataType:"json",
                            type: "POST",
                            async: false,
                        }
                    ).done(permiso);
                        
                  //carga datos de usuario
                                   
                    var url = '{{path('servicio_usuario_id',{'id':'cod'}) }}';
                    var ruta = url.replace('cod',id);
                    $.ajax(
                        {   url : ruta,
                            dataType:"json",
                            type: "POST",
                            async: false,
                        }
                    ).done(user);
               }
                    
        }
       
		
	$(document).ready(function() {
            
            
           $('#divusuario').css({'display':'none'});

                     
           $('#usuariodiv').css({'display':'none'});
				
           $("#myForm").submit(function(event){

           event.preventDefault();
            //get the url for the form
            var url=$("#myForm").attr("action");
            
            console.log($('#myForm').serialize());
           
            $.post(url,{
             formName:$("#myForm").serialize(),
                other:"attributes"
             },function(data){
                    //the response is in the data variable
                    console.log(data);

               if(data.responseCode===200 ){           
                      
                 alert('Registro Completado');
                 var href="{{path('main')}}";
                 //location.reload();
                   
              //   $(location).attr('href',href); 
          
               }
               else if(data.responseCode===400){//bad request
                       alert('Error');
                        }
                    else{
                        if(data.responseCode===500)
                        {
                            alert('Solo se puede registrar una iglesia');
                        }
                        //if we got to this point we know that the controller
                        //did not return a json_encoded array. We can assume that           
                        //an unexpected PHP error occured
                        else 
                            if(data.responseCode===600)
                                alert('Ingrese su ID');
                            else alert("An unexpeded error occured.");
                   }
             }
             );

            return false;});              
        } );

       </script>
      {%endblock %}
