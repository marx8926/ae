{% extends "::base.html.twig" %}
        
{% block stylesheets %}
        <link href="{{asset('css/bootstrap.css')}}" media="screen" rel="stylesheet" type="text/css">
        <link href="{{asset('css/style.css')}}" media="screen" rel="stylesheet" type="text/css">
        <link href="{{asset('css/bootstrap-responsive.css')}}" media="screen" rel="stylesheet" type="text/css">
        <link href="{{asset('css/DT_bootstrap.css')}}">
{% endblock %}

{%block content %}
<div class="span9" id="registro_form">
    <form class="form-horizontal" action="{{path('enviar_addcelula')}}"  method="POST" id="myForm">
       
    </form>      
</div>         
{% endblock %}
     
{%block javascript %}
	<script src="{{asset('js/jquery.js')}}"></script>
	<script src="{{asset('js/less.js')}}"></script>
	<script src="{{asset('js/bootstrap.js')}}"></script>
	<script src="{{asset('js/bootstrap.min.js')}}"></script>
	<script src="{{asset('js/jquery.peity.js')}}"></script>
	<script src="{{asset('js/jquery.fancybox.js')}}"></script>
	<script src="{{asset('js/jquery.flot.js')}}"></script>
	<script src="{{asset('js/jquery.color.js')}}"></script>
	<script src="{{asset('js/jquery.flot.resize.js')}}"></script>
	<script src="{{asset('js/custom.js')}}"></script>            
    <script src="https://maps.google.com/maps/api/js?sensor=false"></script>
    <script src="{{asset('js/jquery-addresspicker/lib/jquery-ui-1.8.7.min.js')}}" > </script>
    <script src="{{asset('js/jquery-addresspicker/src/jquery.ui.addresspicker.js')}}"> </script>     
    <script src="{{asset('js/bootstrap.datepicker.js')}}"></script>
  	<script src="{{asset('js/jquery.inputmask.min.js')}}"></script>
	<!--[if lt IE 9]> <script type="text/javascript" src="/net/public/js/html5.js"></script><![endif]-->
	
	<script type="text/javascript">
           
            
               $(document).ready(function(){
                   
                   //lista de iglesias
                        $.ajax(
                        {url : '{{path('servicio_iglesia')}}',
                         dataType:"json",
                        type: "POST",
                        async: false,
                        }
                        ).done(iglesias);
                 
           
                          //lista de redes
                     $.ajax(
                        {url : '{{path('servicio_red')}}',
                         dataType:"json",
                        type: "POST",
                        async: false,
                        }
                      ).done(redes);
           
            
                       //lista de departamentos
                        $.ajax(
                        {url : '{{path('servicio_region')}}',
                         dataType:"json",
                        type: "POST",
                        async: false,
                        }
                        ).done(departamentos);
                 
    
           
                    $("#myForm").submit(function(){
                    //get the url for the form
                    var url=$("#myForm").attr("action");
   
                    //start send the post request
                    $.post(url,{
                        formName:$("#myForm").serialize(),
                        other:"attributes"
                    },function(data){
                    //the response is in the data variable
                   
   
                    if(data.responseCode==200 ){           
                       // $('#output').html(data.greeting);
                        //$('#output').css("color","red");
                        alert('Registro Completado');
                        location.reload();
                    }
                    else if(data.responseCode==400){//bad request
                       // $('#output').html(data.greeting);
                       // $('#output').css("color","red");
                       alert('Error');
                        }
                    else{
                        
                        if(data.responseCode==500)
                        {
                            alert('Solo se puede registrar una iglesia');
                        }
                        //if we got to this point we know that the controller
                        //did not return a json_encoded array. We can assume that           
                        //an unexpected PHP error occured
                        else alert("An unexpeded error occured.");

                        //if you want to print the error:
                        //$('#output').html(data);
                        }
                    }
       
                    );


                    //It is silly. But you should not write 'json' or any thing as the fourth parameter. It should be undefined. I'll explain it futher down

                    //we dont what the browser to submit the form
                    return false;});

                });
           
            </script>            
{%endblock%}